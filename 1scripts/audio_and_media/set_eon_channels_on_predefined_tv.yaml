alias: Set EON Channel On Bravia TV
icon: "mdi:party-popper"
description: 'Sets channel from lovelace (NUM1, NUM2,...) wheather tv is turned on and set to eon or not'
mode: parallel
fields:
  first_digit_channel:
   description: "sets the first digit for channelvolume on the avr (12 => 1) or (123 => 1)"
   example: "1"
  second_digit_channel:
   description: "sets the second digit for channelvolume on the avr (12 => 2) or (123 => 2)"
   example: "8"
  third_digit_channel:
   description: "sets the third digit for channelvolume on the avr (12 => 2) or (123 => 2)"
   example: "0"

sequence:
  - choose:
    - conditions: "{{not is_state('media_player.bedroom_tv','on')}}"
      sequence:
        - service: braviatv_psk.bravia_open_app
          data:
            entity_id: media_player.bedroom_tv
            uri: >-
              com.sony.dtv.com.ug.eon.android.tv.com.ug.eon.android.tv.TvActivity
              
  - wait_template: "{{ is_state('media_player.bedroom_tv', 'on')}}"
  


  # - service: braviatv_psk.bravia_command
  #   data:
  #     entity_id: media_player.bedroom_tv
  #     command_id: CursorLeft
  - delay: 00:00:02

#first digit channel
  - choose:
    - conditions: "{{first_digit_channel is defined}}"
      sequence:
        - service: braviatv_psk.bravia_command
          data:
            entity_id: media_player.bedroom_tv
            command_id: "Num{{first_digit_channel}}"

#second digit channel
  - choose:
    - conditions: "{{second_digit_channel is defined}}"
      sequence:
        - service: braviatv_psk.bravia_command
          data:
            entity_id: media_player.bedroom_tv
            command_id: "Num{{second_digit_channel}}"

#third digit channel
  - choose:
    - conditions: "{{third_digit_channel is defined}}"
      sequence: 
        - service: braviatv_psk.bravia_command
          data:
            entity_id: media_player.bedroom_tv
            command_id: "Num{{third_digit_channel}}"